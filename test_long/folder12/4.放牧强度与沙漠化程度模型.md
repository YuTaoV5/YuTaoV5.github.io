# 4.放牧强度与沙漠化程度模型
## 问题一:沙漠化建模
沙漠化相关关系的指标因子可以考虑
- **风速**、**降水**、**气温**（三个气象因素）
- **植被盖度**、**地表水资源**、**地下水位**（三个地表因素）
- **人口数量**、**牲畜数量**、**社会经济水平**（三个人文因素）等。

由于人口、牲畜数量、经济GDP只有每年的值，没有每月的值，所以我们对以下变量求每年的平均：风速、降水、气温（三个气象因素）；植被盖度、地表水资源、地下水位（三个地表因素）
人口、牲畜数量、经济生产总值由2021统计年鉴得到，取2012-2020的数据风速、降水、气温由附件8得到植被盖度通过问题2拟合的cp（覆盖率）和NDVI的关系得到地表水资源由附件9径流量得到地下水位直接使用200cm湿度数据, 然后我们需要对这9个指标进行主成分分析PCA，取排名靠前的5个主成分和权重系数。沙漠化程度由着5个主成分加权得到。

## 主成分分析
主成分分析（Principal components analysis，以下简称PCA）是最重要的降维方法之一。在数据压缩消除冗余和数据噪音消除等领域都有广泛的应用。
### PCA算法流程
求样本 $x_i$ 的 $n'$ 维的主成分其实就是求样本集的协方差矩阵 $\frac{1}{m}XX^\top$ 的前 n' 个特征值对应特征向量矩阵 P ，然后对于每个样本 $x_i$ ,做如下变换 $y_i=Px_i$ ，即达到降维的PCA目的。

下面我们看看具体的算法流程：

输入： $n$ 维样本集 $X=(x_1,x_2,...,x_m)$ ，要降维到的维数 $n'$ .

输出：降维后的样本集 Y

1.对所有的样本进行中心化 
$$x_i=x_i-\frac{1}{m}\sum_{j=1}^{m}x_j$$

2.计算样本的协方差矩阵
$$C=\frac{1}{m}XX^\mathsf{T}$$

3.求出协方差矩阵的特征值及对应的特征向量

4.将特征向量按对应特征值大小从上到下按行排列成矩阵，取前k行组成矩阵P

5.Y=PX即为降维到k维后的数据


### 熵值法
一、基本原理
在信息论中，嫡是对不确定性的一种度量。不确定性越大，嫡就越大，包含的信息量越大;不确定性越小，嫡就越小，包含的信息量就越小。
根据嫡的特性，可以通过计算嫡值来判断一个事件的随机性及无序程度，也可以用嫡值来判断某个指标的离散程度，指标的离散程度越大，该指标对综合评价的影响（权重)越大。比如样本数据在某指标下取值都相等，则该指标对总体评价的影响为0，权值为0.
嫡权法是一种客观赋权法，因为它仅依赖于数据本身的离散性。

二、熵值法步骤
1.对n个样本，m个指标，则Cij为第i个样本的第j个指标的数值$(i=1,...,n;j=1,..,m)$;
2.指标的归一化处理:异质指标同质化
由于各项指标的计量单位并不统- ,因此在用它们计算综合指标前,先要进行标准化处理,即把指
标的绝对值转化为相对值,从而解决各项不同质指标值的同质化问题。
另外,正向指标和负向指标数值代表的含义不同(正向指标数值越高越好,负向指标数值越低越
好) ,因此,对于正向负向指标需要采用不同的算法进行数据标准化处理:

$$ \begin{aligned} x_{i j}^{\prime} &=\frac{x_{i j}-\min \left\{x_{1 j}, \ldots, x_{n j}\right\}}{\max \left\{x_{1 j}, \ldots, x_{n j}\right\}-\min \left\{x_{1 j}, \ldots, x_{n j}\right\}} \\ x_{i j}^{\prime} &=\frac{\max \left\{x_{1 j}, \ldots, x_{n j}\right\}-x_{i j}}{\max \left\{x_{1 j}, \ldots, x_{n j}\right\}-\min \left\{x_{1 j}, \ldots, x_{n j}\right\}} \end{aligned} $$

我们令归一化后的数据$x_{ij}^{'}$仍记作$x_{ij}$
3.计算第j项指标下第i个样本值占该指标的比重:

$$
p_{i j}=\frac{x_{i j}}{\sum_{i=1}^{n} x_{i j}}, \quad i=1, \cdots, n, j=1, \cdots, m
$$
4.计算第 $ j $ 项指标的熵值 :
$$
e_{j}=-k \sum_{i=1}^{n} p_{i j} \ln \left(p_{i j}\right), \quad j=1, \cdots, m
$$
其中， $k=1 / \ln (n)>0$. 满足 $e_{j} \geq 0$
5.计算信息熵冗余度 (差异) :
$$ d_{j}=1-e_{j}, \quad j=1, \cdots, m $$

6.计算各项指标的权重 :

$$
w_{j}=\frac{d_{j}}{\sum_{j=1}^{m} d_{j}}, \quad j=1, \cdots, m
$$
7.计算各样本的综合得分：
$$
s_{i}=\sum_{j=1}^{m} w_{j} x_{i j}, \quad i=1, \cdots, n
$$
其中， $x_{i j}$ 为标准化后的数据。


## 问题二:给出定量的土壤板结化定义
关于土壤板结化程度：土壤湿度w越少，容重c越大，有机物含量o越低，土壤板结化程度越严重。
土壤湿度使用10cm湿度，有机物含量使用附件14有机碳数据， 
然后我们使用熵权法确定3个评价指标的权重，土壤板结化程度由这3个量加权得到
（注：这里我们没有容重这个数据，可以编或者忽略这个因素。）
Y2=b1*x1+b2*x2+b3*x3
其中x1~x3分别代表上面3个指标，Y2为土壤板结化程度


## 问题三:给出放牧策略模型，使得沙漠化程度指数与板结化程度最小
给出放牧策略模型，使得沙漠化程度指数与板结化程度最小。
两个优化目标，优化变量为放牧策略，对于多目标优化问题，可以将两个优化目标加权求和变成单目标求解

优化目标Y3=沙漠化程度的权重*沙漠化程度+（1-沙漠化程度的权重）*土壤板结化程度
求最优的放牧强度，使得Y3最小

下面的公式中，$x1~x9$代表沙漠化程度相关的因素，$x1^*~x3^*$代表土壤板结化程度相关因素。这一共12个因素，其中几个因素和问题1的模型中的变量有对应关系，对于没有对应关系的因素，我们直接将它们取最近一年（2021年）的值。通过迭代或者遗传算法或者粒子群等等算法（算法很多，可以语文建模）求解这个模型，我们可以得到最优的放牧强度（放牧方式不用管），最优的放牧强度可以编（语文建模）
$$ \quad S(t)=\arg \min Y 3=\lambda Y 1+(1-\lambda) Y 2 $$
$$ \left\{\begin{array}{l}Y 1=a_{1} x_{1}+a_{2} x_{2}+a_{3} x_{3}+a_{4} x_{4}+a_{5} x_{5}+a_{6} x_{6}+a_{7} x_{7}+a_{8} x_{8}+a_{9} x_{9}\\Y 2=b_{1} x_{1}{ }^{*}+b_{2} x_{2}{ }^{*}+b_{3} x_{3}{ }^{*}\\x_{2}=P\\x_{4}=c_{p}\\x_{6}=W\\x_{1}{ }^{*}=W\\ x_{3}{ }^{*}=Z_w(t) \\\frac{d Z_w(t)}{d t}=a Z_w(t)\left(1-\frac{Z_w(t)}{b}\right)-c S(t)Z_w(t) \\\Delta W=P-\left(E t_{a}+G_{d}+I C_{\text {store }}\right) \\ I C_{\text {store }}(t)=c_{p}(t) \cdot I C_{\max }(t) \cdot\left[1-\exp \left(-k \cdot P(t) / I C_{\max }(t)\right)\right] \\ I C_{\max }(t)=0.935+0.498 \cdot L A I(t)-0.00575 \cdot L A I(t)^{2} \\ c_{p}(t)=\left[\alpha^{*}-W\left(e^{\varepsilon_g, w(t) / w^{*}}-1\right)-1.8 S(t)\right]\left(1-e^{-\varepsilon, \varepsilon^{g}(t) / w^{*}}\right) \\ L A I(t)=a \cdot \exp (k \cdot N D V I) \\ W(t)=\int_{0-100 c m} \beta(t, h) d h \end{array}\right.$$